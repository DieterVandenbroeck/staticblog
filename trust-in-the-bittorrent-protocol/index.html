<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

	<title>Trust in the BitTorrent protocol</title>

	<meta name="HandheldFriendly" content="True" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<link rel="stylesheet" type="text/css" href="../assets/css/style.css%3Fv=7903016016.css" />

	<meta name="description" content="Torrents are a common way of sharing files between peers. The BitTorrent protocol is based on trust. But without centralized governance, does this work?" />
    <link rel="icon" href="../favicon.png" type="image/png" />
    <link rel="canonical" href="https://www.dietervandenbroeck.be/trust-in-the-bittorrent-protocol/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="https://www.dietervandenbroeck.be/trust-in-the-bittorrent-protocol/amp/" />
    
    <meta property="og:site_name" content="Dieter&#x27;s bl0g" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Trust in the BitTorrent protocol" />
    <meta property="og:description" content="Torrents are a common way of sharing files between peers. The BitTorrent protocol is based on trust: share share something, and I&#x27;ll share something. But without centralized governance, does this trust work?" />
    <meta property="og:url" content="https://www.dietervandenbroeck.be/trust-in-the-bittorrent-protocol/" />
    <meta property="og:image" content="https://www.dietervandenbroeck.be/content/images/2018/11/rawpixel-973108-unsplash.jpg" />
    <meta property="article:published_time" content="2013-08-11T08:18:00.000Z" />
    <meta property="article:modified_time" content="2018-12-31T10:26:50.000Z" />
    <meta property="article:tag" content="bittorrent" />
    <meta property="article:tag" content="p2p" />
    <meta property="article:tag" content="peer to peer" />
    <meta property="article:tag" content="torrent" />
    <meta property="article:tag" content="trust" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Trust in the BitTorrent protocol" />
    <meta name="twitter:description" content="Torrents are a common way of sharing files between peers. The BitTorrent protocol is based on trust: share share something, and I&#x27;ll share something. But without centralized governance, does this trust work?" />
    <meta name="twitter:url" content="https://www.dietervandenbroeck.be/trust-in-the-bittorrent-protocol/" />
    <meta name="twitter:image" content="https://www.dietervandenbroeck.be/content/images/2018/11/rawpixel-973108-unsplash.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Dieter Vandenbroeck" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="bittorrent, p2p, peer to peer, torrent, trust" />
    <meta name="twitter:site" content="@dietervandenbro" />
    <meta name="twitter:creator" content="@dietervandenbro" />
    <meta property="og:image:width" content="2000" />
    <meta property="og:image:height" content="1368" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Dieter&#x27;s bl0g",
        "url": "https://www.dietervandenbroeck.be/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://www.dietervandenbroeck.be/favicon.png",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Dieter Vandenbroeck",
        "url": "https://www.dietervandenbroeck.be/author/dieter/",
        "sameAs": [
            "https://twitter.com/dietervandenbro"
        ]
    },
    "headline": "Trust in the BitTorrent protocol",
    "url": "https://www.dietervandenbroeck.be/trust-in-the-bittorrent-protocol/",
    "datePublished": "2013-08-11T08:18:00.000Z",
    "dateModified": "2018-12-31T10:26:50.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://www.dietervandenbroeck.be/content/images/2018/11/rawpixel-973108-unsplash.jpg",
        "width": 2000,
        "height": 1368
    },
    "keywords": "bittorrent, p2p, peer to peer, torrent, trust",
    "description": "Torrents are a common way of sharing files between peers. The BitTorrent protocol is based on trust: share share something, and I&#x27;ll share something. But without centralized governance, does this trust work?",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://www.dietervandenbroeck.be/"
    }
}
    </script>

    <meta name="generator" content="Ghost 4.22" />
    <link rel="alternate" type="application/rss+xml" title="Dieter&#x27;s bl0g" href="https://www.dietervandenbroeck.be/rss/" />
    <script defer src="https://unpkg.com/@tryghost/portal@~1.12.0/umd/portal.min.js" data-ghost="https://www.dietervandenbroeck.be/" crossorigin="anonymous"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style><style>:root {--ghost-accent-color: #15171A;}</style>
	
	<!-- Google Analytics code -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-43104993-1"></script>
	<script type="text/javascript" src="../assets/js/google_analytics.js%3Fv=7903016016"></script>
	
</head>

<body class="post-template tag-bittorrent tag-p2p tag-peer-to-peer tag-torrent tag-trust">

	<nav id="menu">
	<a class="close-button">Close</a>
	<div class="nav-wrapper">
		<p class="nav-label">Menu</p>
		<ul>
			<li class="nav-home" role="presentation"><a href="https://www.dietervandenbroeck.be">Home</a></li>
			<li class="nav-responsible-disclosure" role="presentation"><a href="https://www.dietervandenbroeck.be/responsible-disclosure/">Responsible disclosure</a></li>
			<li class="nav-author" role="presentation"><a href="https://www.dietervandenbroeck.be/about-me/">Author</a></li>
			<li class="nav-twitter"><a href="https://twitter.com/dietervandenbro" title="@dietervandenbro"><i class="ic ic-twitter"></i> Twitter</a></li>
			<li class="nav-rss"><a href="https://www.dietervandenbroeck.be/rss/"><i class="ic ic-rss"></i> Subscribe</a></li>
		</ul>
	</div>
</nav>


	<section id="wrapper">
		<a class="hidden-close"></a>
		

<div class="progress-container">
	<span class="progress-bar"></span>
</div>

<header id="post-header" class="has-cover" >
	<div class="inner">
		<nav id="navigation">
			<span id="home-button" class="nav-button">
				<a class="home-button" href="https://www.dietervandenbroeck.be" title="Home"><i class="ic ic-arrow-left"></i> Home</a>
			</span>
			<span id="menu-button" class="nav-button">
				<a class="menu-button"><i class="ic ic-menu"></i> Menu</a>
			</span>
		</nav>
		<h1 class="post-title">Trust in the BitTorrent protocol</h1>
		<span class="post-meta"><a href="../author/dieter/index.html">Dieter Vandenbroeck</a> | <time datetime="2013-08-11">11 Aug 2013</time></span>
		<div class="post-cover cover"></div>  
		<style nonce="8375f3e45533d576a3869ff9c792a673"> div.post-cover {background-image: url('https://www.dietervandenbroeck.be/content/images/2018/11/rawpixel-973108-unsplash.jpg'); }</style>"
	</div>
</header>

<main class="content" role="main">
	<article class="post tag-bittorrent tag-p2p tag-peer-to-peer tag-torrent tag-trust">
		<div class="inner">

			<section class="post-content">
				<p>Distributed, decentralized solutions are cool. Although they are harder to create and maintain and have specific problems related to their nature, they have some really nice advantages (including scalability and potentially security). With the recent exposure of PRISM, a lot of 'proposed solutions' (mostly secure alternatives to Gmail) are fully decentralized.</p><p>One of the most-used distributed protocols is BitTorrent. Of course there are 2 parts to this protocol: the decentralized part -where users exchange the data/files- and the centralized part -the tracker that keeps track of all files and their exchange. For private trackers, the work doesn't stop here. Users of private trackers need to maintain a ratio, so the tracker also needs to keep track of what user is downloading what file, and what user is uploading that file. Because multiple users can be involved in the distribution of a single file (there is no limit, everyone can upload the parts that he has available), this would not be scalable.</p><p>Curious about how this is managed, I checked the <a href="http://www.bittorrent.org/beps/bep_0003.html">documentation</a>. When looking at the different parameters, I noticed the 'uploaded' and 'downloaded' parameters. It seemed like the tracker would just trust the client, without any questions asked. As this seemed very optimistic (because yes, of course every BitTorrent client can be fully trusted) and a lot of extensions exist to the protocol (including DHT), I decided to do a few tests with public torrents (e.g. iso images of Ubuntu and Fedora) and some private trackers as well (2 different).</p><p>With a default installation and configuration of uTorrent (together with WireShark for all plain-text communication and Burp Suite as proxy for all communication to the tracker), I started a torrent and saw -even though the first request was still not forwarded by Burp- that the file already started downloading. It even seemed like forwarding the request was just a formality. With a good connection, the download was completed in 15 minutes and only 3 requests had come through. So, time for some further investigation.</p><p>The first packet sent is the scrape; this initial request sends the hash of the file(s) and 1) confirms the information present in the .torrent file and 2) makes sure that the tracker is online .The following is an example scrape (note that tracker responses are bencoded):</p><!--kg-card-begin: markdown--><p><strong>-request-</strong><br>
GET /scrape?infohash=%f4%19%89%f9yz%88P%9e%25%8d%5e%5d%13T%c3s%1a%99 HTTP/1.1</p>
<p><strong>-response-</strong> d5:filesd20:....yz.P_.%.^].T.s..d8:completei1231e10:downloadedi12e10:incompletei55e4:name30:ubuntu-13.04-desktop-amd64.isoeee</p>
<!--kg-card-end: markdown--><p>More important are the next 2 packets, the announce packets. The only difference between the first packet sent out (shown below) and the last packet were the parameters shown. Because DHT was used, this packet that includes the list of peers was not even required; uTorrent already had started the download, not needing the information from the tracker.</p><!--kg-card-begin: markdown--><p><strong>-request-</strong><br>
GET /announce? infohash=%f4%19%89%f9yz%88P%9e%25%8d%5e%5d%13T%c3s%1a%99&amp; uploaded=0&amp; downloaded=0&amp; left=823132160&amp; event=started</p>
<p><strong>-response-</strong><br>
d8:completei1240e10:incompletei59e8:intervali1800e5:peers300:</p>
<!--kg-card-end: markdown--><p>With this knowledge, the main question for me -related to private trackers- was: does the tracker check this information and can you spoof upload (to increase your ratio). Note that this question was only from a curiosity perspective; I'm a fan of BitTorrent and private trackers, and believe that this can only work if indeed every users participates in uploading as well.</p><p>An hour later, I had my python script ready and started to test my theory on 2 private trackers. The results I collected were pretty interesting: 1) Yes, it's possible to spoof upload to boost your ratio. 2) Private trackers do have detection mechanisms to detect this.</p><p>The first can be considered a strength and a weakness of the protocol. The tracker will be unaware of the detailed file exchange: it gives a list of potential peers upon request, and receives information that can be used to determine the ratio of a user. However, it has no idea what user is downloading a file from what other user. This greatly decreases the complexity of the protocol (and it's easier to use it in a variety of scenarios). But this also means private trackers have to check the received information against what they are collection, something they can never do with 100% certainty.</p><p>I discussed these findings with some staff of the private trackers I used, read some more on this issue and even looked at the source of Ocelot (an open source tracker). In the end,</p><ul><li>the protocol itself limits the exposure of every user only very little; torrents with little users still expose uploads and downloads between users.</li><li>the protocol itself is not sufficient to correctly keep track of ratios.</li><li>fraud detection cannot be done 100% reliably; trust on client programs is still important and detection can only happen if only a very small number of users is fraudulent.</li><li>it's likely that you can spoof upload without being detected (my script didn't always work as expected and I was rather low on patience).</li></ul><p></p>
			</section>

			<section class="post-info">

				<aside class="post-tags">
					<a href="../tag/bittorrent/index.html">bittorrent</a> <a href="../tag/p2p/index.html">p2p</a> <a href="../tag/peer-to-peer/index.html">peer to peer</a> <a href="../tag/torrent/index.html">torrent</a> <a href="../tag/trust/index.html">trust</a>
				</aside>

				<div class="clear"></div>

						<aside class="post-author">
							<figure class="post-author-avatar avatar">
							</figure>
							<div class="post-author-bio">
								<h4 class="post-author-name"><a href="../author/dieter/index.html">Dieter Vandenbroeck</a></h4>
									<span class="post-author-location"><i class="ic ic-location"></i> Begium</span>
									<span class="post-author-twitter"><i class="ic ic-twitter"></i> <a target="_blank" href="https://twitter.com/@dietervandenbro">Twitter</a></span>
							</div>
							<div class="clear"></div>
						</aside>

			</section>


			<section class="post-comments">
				<a id="show-disqus" class="post-comments-activate">Show Comments</a>
			    <div id="disqus_thread"></div>
			</section>


			<aside class="post-nav">
					<a class="post-nav-next" href="../when-security-through-obscurity-is-a-good-idea/index.html">
						<section class="post-nav-teaser">
							<i class="ic ic-arrow-left"></i>
							<h2 class="post-nav-title">When security through obscurity is a good idea</h2>
							<p class="post-nav-excerpt">Security through obscurity is considered bad practice. But what if we can hinder an attacker just that bit more by providing obscurity without relying on it as a security principle?&hellip;</p>
						</section>
					</a>
					<a class="post-nav-prev" href="../so-you-want-to-inspect-that-encrypted-traffic/index.html">
						<section class="post-nav-teaser">
							<i class="ic ic-arrow-right"></i>
							<h2 class="post-nav-title">So you want to inspect that encrypted traffic</h2>
							<p class="post-nav-excerpt">HTTPS is the standard to securely browse the internet. But what if your 'secure' traffic is inspected nevertheless? Many companies intercept and inspect your secure traffic.&hellip;</p>
						</section>
					</a>
				<div class="clear"></div>
			</aside>


		</div>
	</article>
</main>


		<div id="body-class" class="post-template tag-bittorrent tag-p2p tag-peer-to-peer tag-torrent tag-trust"></div>

		<footer id="footer">
			<div class="inner">
				<section class="credits">
					<span class="credits-software">Published with <a href="https://ghost.org">Ghost</a> using <a href="https://www.digitalocean.com/">DigitalOcean</a></span>
				</section>
			</div>
		</footer>
	</section>

	<script type="text/javascript" src="../assets/js/script.js%3Fv=7903016016"></script>

	

</body>
</html>
