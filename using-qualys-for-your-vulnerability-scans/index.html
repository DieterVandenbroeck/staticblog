<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

	<title>Qualys for your vulnerability scans: the good, the bad and the ugly</title>

	<meta name="HandheldFriendly" content="True" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<link rel="stylesheet" type="text/css" href="../assets/css/style.css%3Fv=7903016016.css" />

	<meta name="description" content="Vulnerability scans are a cost-effective method of identifying vulnerabilities in your network. Qualys scores well in reviews, but what about the bad side?" />
    <link rel="icon" href="../favicon.png" type="image/png" />
    <link rel="canonical" href="https://www.dietervandenbroeck.be/using-qualys-for-your-vulnerability-scans/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="https://www.dietervandenbroeck.be/using-qualys-for-your-vulnerability-scans/amp/" />
    
    <meta property="og:site_name" content="Dieter&#x27;s bl0g" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Qualys for your vulnerability scans: the good, the bad and the ugly" />
    <meta property="og:description" content="Vulnerability scans are a cost-effective method of identifying vulnerabilities in your network. Often different vulnerability scanning solutions are compared, only a few differences in the results are highlighted and Qualys scores well. Often the negative points are not included..." />
    <meta property="og:url" content="https://www.dietervandenbroeck.be/using-qualys-for-your-vulnerability-scans/" />
    <meta property="og:image" content="https://www.dietervandenbroeck.be/content/images/2018/11/mahir-uysal-568303-unsplash.jpg" />
    <meta property="article:published_time" content="2016-07-29T17:47:00.000Z" />
    <meta property="article:modified_time" content="2018-12-31T10:29:06.000Z" />
    <meta property="article:tag" content="vulnerability management" />
    <meta property="article:tag" content="qualys" />
    <meta property="article:tag" content="pci dss" />
    <meta property="article:tag" content="vulnerability scanning" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Qualys for your vulnerability scans: the good, the bad and the ugly" />
    <meta name="twitter:description" content="Vulnerability scans are a cost-effective method of identifying vulnerabilities in your network. Often different vulnerability scanning solutions are compared, only a few differences in the results are highlighted and Qualys scores well. Often the negative points are not included..." />
    <meta name="twitter:url" content="https://www.dietervandenbroeck.be/using-qualys-for-your-vulnerability-scans/" />
    <meta name="twitter:image" content="https://www.dietervandenbroeck.be/content/images/2018/11/mahir-uysal-568303-unsplash.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Dieter Vandenbroeck" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="vulnerability management, qualys, pci dss, vulnerability scanning" />
    <meta name="twitter:site" content="@dietervandenbro" />
    <meta name="twitter:creator" content="@dietervandenbro" />
    <meta property="og:image:width" content="2000" />
    <meta property="og:image:height" content="1333" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Dieter&#x27;s bl0g",
        "url": "https://www.dietervandenbroeck.be/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://www.dietervandenbroeck.be/favicon.png",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Dieter Vandenbroeck",
        "url": "https://www.dietervandenbroeck.be/author/dieter/",
        "sameAs": [
            "https://twitter.com/dietervandenbro"
        ]
    },
    "headline": "Qualys for your vulnerability scans: the good, the bad and the ugly",
    "url": "https://www.dietervandenbroeck.be/using-qualys-for-your-vulnerability-scans/",
    "datePublished": "2016-07-29T17:47:00.000Z",
    "dateModified": "2018-12-31T10:29:06.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://www.dietervandenbroeck.be/content/images/2018/11/mahir-uysal-568303-unsplash.jpg",
        "width": 2000,
        "height": 1333
    },
    "keywords": "vulnerability management, qualys, pci dss, vulnerability scanning",
    "description": "Vulnerability scans are a cost-effective method of identifying vulnerabilities in your network. Often different vulnerability scanning solutions are compared, only a few differences in the results are highlighted and Qualys scores well. Often the negative points are not included...",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://www.dietervandenbroeck.be/"
    }
}
    </script>

    <meta name="generator" content="Ghost 4.22" />
    <link rel="alternate" type="application/rss+xml" title="Dieter&#x27;s bl0g" href="https://www.dietervandenbroeck.be/rss/" />
    <script defer src="https://unpkg.com/@tryghost/portal@~1.12.0/umd/portal.min.js" data-ghost="https://www.dietervandenbroeck.be/" crossorigin="anonymous"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style><style>:root {--ghost-accent-color: #15171A;}</style>
	
	<!-- Google Analytics code -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-43104993-1"></script>
	<script type="text/javascript" src="../assets/js/google_analytics.js%3Fv=7903016016"></script>
	
</head>

<body class="post-template tag-vulnerability-management tag-qualys tag-pci-dss tag-vulnerability-scanning">

	<nav id="menu">
	<a class="close-button">Close</a>
	<div class="nav-wrapper">
		<p class="nav-label">Menu</p>
		<ul>
			<li class="nav-home" role="presentation"><a href="https://www.dietervandenbroeck.be">Home</a></li>
			<li class="nav-responsible-disclosure" role="presentation"><a href="https://www.dietervandenbroeck.be/responsible-disclosure/">Responsible disclosure</a></li>
			<li class="nav-author" role="presentation"><a href="https://www.dietervandenbroeck.be/about-me/">Author</a></li>
			<li class="nav-twitter"><a href="https://twitter.com/dietervandenbro" title="@dietervandenbro"><i class="ic ic-twitter"></i> Twitter</a></li>
			<li class="nav-rss"><a href="https://www.dietervandenbroeck.be/rss/"><i class="ic ic-rss"></i> Subscribe</a></li>
		</ul>
	</div>
</nav>


	<section id="wrapper">
		<a class="hidden-close"></a>
		

<div class="progress-container">
	<span class="progress-bar"></span>
</div>

<header id="post-header" class="has-cover" >
	<div class="inner">
		<nav id="navigation">
			<span id="home-button" class="nav-button">
				<a class="home-button" href="https://www.dietervandenbroeck.be" title="Home"><i class="ic ic-arrow-left"></i> Home</a>
			</span>
			<span id="menu-button" class="nav-button">
				<a class="menu-button"><i class="ic ic-menu"></i> Menu</a>
			</span>
		</nav>
		<h1 class="post-title">Using Qualys for your vulnerability scans: the good, the bad and the ugly</h1>
		<span class="post-meta"><a href="../author/dieter/index.html">Dieter Vandenbroeck</a> | <time datetime="2016-07-29">29 Jul 2016</time></span>
		<div class="post-cover cover"></div>  
		<style nonce="35c8bd1624a8baa35a31c5f230d8b806"> div.post-cover {background-image: url('https://www.dietervandenbroeck.be/content/images/2018/11/mahir-uysal-568303-unsplash.jpg'); }</style>"
	</div>
</header>

<main class="content" role="main">
	<article class="post tag-vulnerability-management tag-qualys tag-pci-dss tag-vulnerability-scanning">
		<div class="inner">

			<section class="post-content">
				<p>Vulnerability scans are a cost-effective method of identifying vulnerabilities in your network. In most posts whereby vulnerability scanning solutions are compared, Qualys scores well. Something that seems to be missing in most of these comparisons and reviews are the negative points. One of the big players in this field can’t be perfect, right?</p><p>Recently I reached out to the local Technical Account Manager of Qualys to discuss an overview of negatives I compiled from experience. I’ve used the Vulnerability Management modules in different companies in different types of deployments and often the same problems came back. To ensure I wasn’t screwing up I set down to discuss my frustrations and learned that I’m not alone with some of the frustrations, but that apparently I’m also very good at finding the companies that deployed and use Qualys in ways related to difficulties. Sharing is caring, so hereby a complete overview of everything you might want to take into consideration when looking for a vulnerability scanning provider.</p><p><strong><strong>Networking issues are almost impossible to troubleshoot</strong></strong> The world we live in is far from perfect, and so are the networks that organizations (try to) manage. In theory, the network team will configure the Qualys interface (on the switch) so the appliance can operate as expected and all routes to various hosts and firewalls exist and behave as they should. This sounds too good to be true, and an organization that segments its network and didn’t built this network from scratch in the last 5 years will know this.</p><p>You notice something isn’t quite right and you think “a problem is only an unsolved challenge”.</p><p><em>Step one</em>: you try to better understand the problem. How about “I know host X is up and running but it is not scanned”.</p><p><em>Step two</em>: you check the scanner’s network configuration, check if you can ping X, perform a traceroute to validate the validity of the route, etc. Should be simple and straightforward, but in reality this is one of the hardest things to accomplish:</p><ul><li>You can check the IP configuration, but that’s it. If there’s a very basic, stupid problem with the actual cable (imagine mice chewed through it or the cleaning lady unplugged it), you won’t know this (at least not with a physical appliance). Qualys does not allow you to know the status of the network interface if you’re not looking at the cable and the interface itself.</li><li>Ping a host? Of course this is possible, they’re not barbaric! But it’s not as straightforward as you might imagine. Because you are allowed to create custom scan profiles, you can make a stripped down profile that only attempts to ping the ‘scanned’ host. Of course there’s a delay between issuing the command to start the ‘scan’ and getting the results (the time to schedule the scan, at most 60 seconds between starting the scan and the appliance connecting to the QualysGuard cloud platform and receiving the instructions, the time to execute the ‘scan’, at most 60 seconds between the end of the scan and the appliance connecting to the QualysGuard cloud platform, and then the time to process the results). No, definitely not straightforward and easily taking up a few minutes.</li><li>Executing a traceroute to identify where exactly the problem is? That’s only possible if you can actually reach the host (ping or receive a response on a chosen TCP / UDP port). Just to make sure the message isn’t lost in translation: yes you can trace the route between the Qualys appliance and your chosen target, but you will only receive the result if Qualys can actually reach the target because of the way Qualys operates (a traceroute is something that can be performed during a scan, but if the target is not deemed alive the actual scan is not executed).</li><li>You need the MAC address for your physical Qualys appliance? You should have registered this information when deploying the appliance in your network! With the more recent appliances you can’t rely on the prefixes anymore as well, because at least 1 additional address range was started (nowhere near the first range, so at least two MAC address prefixes should be remembered now as they’re not documented). Luckily Qualys support can provide this information, given you can wait a couple of days to weeks).</li><li>Lastly, you should be able to fully rely on your DNS server’s information. In some cases you would really prefer to configure this information on your scanner (in the hosts file), but updating the DNS servers is the only solution here.</li></ul><p>The reasoning behind these restrictions is pretty clear: lock down the box as much as possible and limit end-user interaction to some predefined actions that are sent through the cloud platform. In an organization where the vulnerability management team has no direct access to anything on the network and cannot quickly troubleshoot anything using a laptop and the scanner’s cable (as recommended in the user’s guide), often there’s a real need for an “Expert interface” that offers some additional functionality in a restricted mode of operation to protect the appliance.</p><p>The new version (v8.8, pushed yesterday) of the Vulnerability Management module should offer a (partial) solution: launching a PCAP scan does the same as launching a debug scan but you get the results this time. You can only launch such a scan against a single endpoint (to limit impact on the scanner), but it’s a start right?</p><p><strong><strong>Be careful when configuring the network interfaces of your virtual appliances</strong></strong> You’re not obliged to deploy dedicated physical scanners. To make deployment and management easier, Qualys provides the possibility to deploy a virtual scanner. Just like with physical appliances it is possible to use a dual-NIC configuration; in this configuration one interface is used for management purposes (and connects only to the QualysGuard cloud platform) and another interface is only used for scanning purposes (and never connects outside of your internal network).</p><p>When different types of network interfaces are configured (VMWare for example has 7 different types), a warning will be shown when the appliance boots. Although I’m not aware of a good reason to have such a configuration, it won’t hinder Qualys’ functionality. But Qualys thinks this warning is sufficiently important so forces the end-user to acknowledge this warning. Considering an environment whereby the people responsible for vulnerability management activities often don’t have access to servers / virtual machines and one of the first steps in troubleshooting Qualys appliances is to reboot them, this can easily degrade scanning capabilities. And it shouldn’t.</p><p>Apparently around the end of this month the new scanner image would be pushed and would contain a fix. Let’s hope this was a one-off issue. </p><figure class="kg-card kg-image-card"><img src="https://www.dietervandenbroeck.be/content/qualys_interface_error.jpg" class="kg-image" alt="qualys_interface_error.jpg" loading="lazy"></figure><p><em><em>End-user acknowledgment is required when booting the virtual appliance.</em></em></p><p><strong><strong>Qualys support can be the good, but is often the bad AND the ugly</strong></strong> Where to start on this one? One side of this story is simple and easy to tell: when you’ve reached one the really good support engineers, you’ll receive a straightforward answer from an engineer who doesn’t just answer your question / solve your problem but provides background information on the root cause and alternatives.</p><p>All too often, you’ll end up with the other side: long interactions with first line that are completely missing the point, go in circles and –worst of all- start from scratch again when a new engineer is assigned. And don’t hope you can skid through this (often mandatory) phase quickly: you may receive generic answers when the SLA gets close, and there’s a high chance you’ll get frustrated before getting an answer and getting your message through (in case of a more complicated problem or a very non-standard question that can’t be answered using the existing information).</p><p>Qualys informed me this is an area with room for improvement, to keep the company’s account manager in cc if escalation is required and that the new support platform (Salesforce instead of emails) hopefully already makes a small difference. I’m a skeptical guy hoping for a positive change but without a promising outlook…</p><p><strong><strong>You need to compromise on security to get the appliance working</strong></strong> Everyone’s got a white whale from the past haunting their dreams, and Qualys is no different. To activate a new appliance, a connection to the QualysGuard portal needs to be established. The different between this connection and all other connections is in the security of the connection: appliances still require an outgoing SSLv2/SSLv3 connection. If you want to scan your PCI environment but need to deviate from the standard you’re trying to be compliant with, there seems to be an issue…</p><p>With a little blush on their cheeks, Qualys confirmed that they are working on this. Because this is only applicable to the first activation of an appliance, it doesn’t need to be the biggest issue.</p><p><strong><strong>Authentication reports don’t necessarily reflect the current situation</strong></strong> Qualys has a predefined reporting format that returns information on authentication. This information is very useful for troubleshooting / reporting, but doesn’t necessarily reflect the current situation (so can be more than useless, can be misleading and make you report the wrong numbers to management…).</p><ul><li>If Qualys authenticates to host X at a certain point in time but does not attempt to authenticate at subsequent scans, this authentication status will be retained in the report. If data is not purged, this report could include successful authentication to many hosts that are not scanned anymore (e.g. hosts that have been decommissioned).</li><li>It is possible that multiple authentication records are linked to a certain host, and all of them will be attempted (e.g. AD domain authentication + NETBIOS authentication, or Windows authentication + Unix authentication). This could result in a host being reported as unsuccessful authentication, even though an authenticated scan was performed successfully but one of the authentication attempts failed.</li></ul><p>The input from Qualys is quite simple; they recommend looking at the actual QIDs related to authentication and to use these numbers. Using the QIDs it can be rather hard to determine the exact success / fail rate (due to both Windows and Unix authentication on a single host, both success and failure on single hosts, Windows Authentication QIDs with (null) authentication and actual success information, etc.).</p><p>If you can’t automate the reporting output based on QIDs, you need a lot of patience and luck to figure out the correct status.</p><p>[1] <a href="https://www.qualys.com/docs/qualys-virtual-scanner-appliance-user-guide.pdf">https://www.qualys.com/docs/qualys-virtual-scanner-appliance-user-guide.pdf</a> </p><p>[2] <a href="https://kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;cmd=displayKC&amp;externalId=1001805">https://kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;cmd=displayKC&amp;externalId=1001805</a></p>
			</section>

			<section class="post-info">

				<aside class="post-tags">
					<a href="../tag/vulnerability-management/index.html">vulnerability management</a> <a href="../tag/qualys/index.html">qualys</a> <a href="../tag/pci-dss/index.html">pci dss</a> <a href="../tag/vulnerability-scanning/index.html">vulnerability scanning</a>
				</aside>

				<div class="clear"></div>

						<aside class="post-author">
							<figure class="post-author-avatar avatar">
							</figure>
							<div class="post-author-bio">
								<h4 class="post-author-name"><a href="../author/dieter/index.html">Dieter Vandenbroeck</a></h4>
									<span class="post-author-location"><i class="ic ic-location"></i> Begium</span>
									<span class="post-author-twitter"><i class="ic ic-twitter"></i> <a target="_blank" href="https://twitter.com/@dietervandenbro">Twitter</a></span>
							</div>
							<div class="clear"></div>
						</aside>

			</section>


			<section class="post-comments">
				<a id="show-disqus" class="post-comments-activate">Show Comments</a>
			    <div id="disqus_thread"></div>
			</section>


			<aside class="post-nav">
					<a class="post-nav-next" href="../brucon-0x08-ey-challenge-write-up/index.html">
						<section class="post-nav-teaser">
							<i class="ic ic-arrow-left"></i>
							<h2 class="post-nav-title">BruCON 0x08 EY challenge write-up</h2>
							<p class="post-nav-excerpt">During the last edition of BruCON, EY hosted a Capture The Flag challenge titled: “Packetception” and “sign-me”. This write-up guides you through the challenges to the solution.&hellip;</p>
						</section>
					</a>
					<a class="post-nav-prev" href="../bug-bounty-programs-heaven-or-hell/index.html">
						<section class="post-nav-teaser">
							<i class="ic ic-arrow-right"></i>
							<h2 class="post-nav-title">Bug bounty programs: creating heaven for ethical hackers or opening the gates to mischief?</h2>
							<p class="post-nav-excerpt">Bug bounty programs can be a cost-effective method for the detection of vulnerabilities, but what is the reward's tipping point? When is it more interesting for an ethical hacker to sell a vulnerability that was identified without risking detection instead of submitting through your program?&hellip;</p>
						</section>
					</a>
				<div class="clear"></div>
			</aside>


		</div>
	</article>
</main>


		<div id="body-class" class="post-template tag-vulnerability-management tag-qualys tag-pci-dss tag-vulnerability-scanning"></div>

		<footer id="footer">
			<div class="inner">
				<section class="credits">
					<span class="credits-software">Published with <a href="https://ghost.org">Ghost</a> using <a href="https://www.digitalocean.com/">DigitalOcean</a></span>
				</section>
			</div>
		</footer>
	</section>

	<script type="text/javascript" src="../assets/js/script.js%3Fv=7903016016"></script>

	

</body>
</html>
