<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

	<title>Facebook brute-forced its way on Tor</title>

	<meta name="HandheldFriendly" content="True" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<link rel="stylesheet" type="text/css" href="../assets/css/style.css%3Fv=7903016016.css" />

	<meta name="description" content="Facebook is now available as a hidden service on Tor. Although connections are still to the same website, Facebook brute-forced its digital key for this." />
    <link rel="icon" href="../favicon.png" type="image/png" />
    <link rel="canonical" href="https://www.dietervandenbroeck.be/facebook-brute-forced-its-way-on-tor/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="https://www.dietervandenbroeck.be/facebook-brute-forced-its-way-on-tor/amp/" />
    
    <meta property="og:site_name" content="Dieter&#x27;s bl0g" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Facebook brute-forced its way on Tor" />
    <meta property="og:description" content="Facebook is now available as a hidden service on Tor. Although connections are still towards the same website, Facebook had to brute-force it&#x27;s digital key-pair to do this." />
    <meta property="og:url" content="https://www.dietervandenbroeck.be/facebook-brute-forced-its-way-on-tor/" />
    <meta property="og:image" content="https://www.dietervandenbroeck.be/content/images/2018/11/glen-carrie-773789-unsplash.jpg" />
    <meta property="article:published_time" content="2014-12-02T07:40:00.000Z" />
    <meta property="article:modified_time" content="2018-12-31T10:30:59.000Z" />
    <meta property="article:tag" content="anonimity" />
    <meta property="article:tag" content="facebook" />
    <meta property="article:tag" content="monitoring" />
    <meta property="article:tag" content="privacy" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Facebook brute-forced its way on Tor" />
    <meta name="twitter:description" content="Facebook is now available as a hidden service on Tor. Although connections are still towards the same website, Facebook had to brute-force it&#x27;s digital key-pair to do this." />
    <meta name="twitter:url" content="https://www.dietervandenbroeck.be/facebook-brute-forced-its-way-on-tor/" />
    <meta name="twitter:image" content="https://www.dietervandenbroeck.be/content/images/2018/11/glen-carrie-773789-unsplash.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Dieter Vandenbroeck" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="anonimity, facebook, monitoring, privacy" />
    <meta name="twitter:site" content="@dietervandenbro" />
    <meta name="twitter:creator" content="@dietervandenbro" />
    <meta property="og:image:width" content="2000" />
    <meta property="og:image:height" content="1333" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Dieter&#x27;s bl0g",
        "url": "https://www.dietervandenbroeck.be/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://www.dietervandenbroeck.be/favicon.png",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Dieter Vandenbroeck",
        "url": "https://www.dietervandenbroeck.be/author/dieter/",
        "sameAs": [
            "https://twitter.com/dietervandenbro"
        ]
    },
    "headline": "Facebook brute-forced its way on Tor",
    "url": "https://www.dietervandenbroeck.be/facebook-brute-forced-its-way-on-tor/",
    "datePublished": "2014-12-02T07:40:00.000Z",
    "dateModified": "2018-12-31T10:30:59.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://www.dietervandenbroeck.be/content/images/2018/11/glen-carrie-773789-unsplash.jpg",
        "width": 2000,
        "height": 1333
    },
    "keywords": "anonimity, facebook, monitoring, privacy",
    "description": "Facebook is now available as a hidden service on Tor. Although connections are still towards the same website, Facebook had to brute-force it&#x27;s digital key-pair to do this.",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://www.dietervandenbroeck.be/"
    }
}
    </script>

    <meta name="generator" content="Ghost 4.22" />
    <link rel="alternate" type="application/rss+xml" title="Dieter&#x27;s bl0g" href="https://www.dietervandenbroeck.be/rss/" />
    <script defer src="https://unpkg.com/@tryghost/portal@~1.12.0/umd/portal.min.js" data-ghost="https://www.dietervandenbroeck.be/" crossorigin="anonymous"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style><style>:root {--ghost-accent-color: #15171A;}</style>
	
	<!-- Google Analytics code -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-43104993-1"></script>
	<script type="text/javascript" src="../assets/js/google_analytics.js%3Fv=7903016016"></script>
	
</head>

<body class="post-template tag-anonimity tag-facebook tag-monitoring tag-privacy">

	<nav id="menu">
	<a class="close-button">Close</a>
	<div class="nav-wrapper">
		<p class="nav-label">Menu</p>
		<ul>
			<li class="nav-home" role="presentation"><a href="https://www.dietervandenbroeck.be">Home</a></li>
			<li class="nav-responsible-disclosure" role="presentation"><a href="https://www.dietervandenbroeck.be/responsible-disclosure/">Responsible disclosure</a></li>
			<li class="nav-author" role="presentation"><a href="https://www.dietervandenbroeck.be/about-me/">Author</a></li>
			<li class="nav-twitter"><a href="https://twitter.com/dietervandenbro" title="@dietervandenbro"><i class="ic ic-twitter"></i> Twitter</a></li>
			<li class="nav-rss"><a href="https://www.dietervandenbroeck.be/rss/"><i class="ic ic-rss"></i> Subscribe</a></li>
		</ul>
	</div>
</nav>


	<section id="wrapper">
		<a class="hidden-close"></a>
		

<div class="progress-container">
	<span class="progress-bar"></span>
</div>

<header id="post-header" class="has-cover" >
	<div class="inner">
		<nav id="navigation">
			<span id="home-button" class="nav-button">
				<a class="home-button" href="https://www.dietervandenbroeck.be" title="Home"><i class="ic ic-arrow-left"></i> Home</a>
			</span>
			<span id="menu-button" class="nav-button">
				<a class="menu-button"><i class="ic ic-menu"></i> Menu</a>
			</span>
		</nav>
		<h1 class="post-title">Facebook brute-forced its way on Tor</h1>
		<span class="post-meta"><a href="../author/dieter/index.html">Dieter Vandenbroeck</a> | <time datetime="2014-12-02">02 Dec 2014</time></span>
		<div class="post-cover cover"></div>  
		<style nonce="61905d28e5c009852d5ef793e8af295c"> div.post-cover {background-image: url('https://www.dietervandenbroeck.be/content/images/2018/11/glen-carrie-773789-unsplash.jpg'); }</style>"
	</div>
</header>

<main class="content" role="main">
	<article class="post tag-anonimity tag-facebook tag-monitoring tag-privacy">
		<div class="inner">

			<section class="post-content">
				<p>About a month ago, Facebook made a big announcement: users that care about their privacy and use Facebook (yes, I know), can now access the Tor-version of the website. This means that users don’t have to go through Tor to go to the “open” www.facebook.com, but can stay within the Tor network itself and go to “Facebook's Core WWW Infrastructure” on the “hidden” facebookcorewwwi.onion. The difference in itself is limited in the sense that you connect to the same website, with the same back-end, with the same ridiculous amount of information stored about you. But for the second version, Facebook had to brute-force its way on Tor.</p><p>Taking the first case, a user connecting to www.facebook.com through Tor, is easy and still closely related to a “regular” connection. Instead of reaching out to his own DNS server and connecting directly (with some additional hops to complete the path) with the Facebook servers, the user’s traffic goes through a number of Tor nodes. But that’s it; the same name is resolved in the same way, and there are just a few additional hops.</p><p>If a user wants to stay within the Tor network (e.g. because he puts more trust in all the NSA relay nodes than having a secured connection ‘in the open’), the Facebook Core WWW Infrastructure is a solution. In this case, Facebook has published its ‘hidden service descriptor’ containing a public key and a description of some introduction points to a distributed hash table** (can be access through a dictionary as in the old days of the Internet). The key on which the service can be found (in this case facebookcorewwwi) is the base32-encoded form of the SHA-1 hash of the public key (1024 bits).</p><p>Because the principle of DNS is not compatible with Tor’s principle of anonymity, another solution is created. After creating a hidden service, a number of introduction points are selected at random. A user that learns about the name of the hidden service chooses its own rendezvous point at random. Using the descriptor (that contains the public key of the hidden service, and descriptions of the introduction points), the user creates an introduce message for the hidden service itself. At this point, the hidden service also connects to the rendezvous point and a “direct” communication channel exists between the user and the hidden service (there are always some additional relay nodes involved, all of the communication and direct connections are represented overly simplified here*).</p><p>But why did Facebook choose that specific name (Facebook Core WWW Infrastructure) with accompanied ‘URL’ facebookcorewwwi.onion? Well, it didn't. In normal situations, the base32-encoded form of the SHA-1 hash of the key-pair created upon creating a hidden service is used as a name. The short description: extremely random names of a fixed length are used, so there is no choice in name. That’s why Facebook is not available at facebook.onion, but somewhere else. Of course, this also means that Facebook kept on generating key-pairs in the hope that the name would result in anything with ‘facebook’ in it, and came up with a description. It’s not entirely clear what kind of effort was put into this, but a Facebook employee disclosed that “(they) got tremendous lucky”.Really, really overly simplified. </p><p>** A distributed version of many things exist: distributed hash tables, distributed file systems, distributed social networks, etc. It’s pretty cool :-)</p><p>[1] <a href="https://www.facebook.com/notes/protect-the-graph/making-connections-to-facebook-more-secure/1526085754298237">https://www.facebook.com/notes/protect-the-graph/making-connections-to-facebook-more-secure/1526085754298237</a> </p><p>[2] <a href="http://archives.seul.org/tor/talk/Oct-2014/msg00433.html">http://archives.seul.org/tor/talk/Oct-2014/msg00433.html</a> </p><p>[3] <a href="https://timtaubert.de/blog/2014/11/using-the-webcrypto-api-to-generate-onion-names-for-tor-hidden-services/">https://timtaubert.de/blog/2014/11/using-the-webcrypto-api-to-generate-onion-names-for-tor-hidden-services/</a> </p><p>[4] <a href="https://www.antitree.com/how-tor-does-dns-the-breaking-bad-way/">https://www.antitree.com/how-tor-does-dns-the-breaking-bad-way/</a> </p><p>[5] <a href="https://www.torproject.org/docs/hidden-services.html.en">https://www.torproject.org/docs/hidden-services.html.en</a></p>
			</section>

			<section class="post-info">

				<aside class="post-tags">
					<a href="../tag/anonimity/index.html">anonimity</a> <a href="../tag/facebook/index.html">facebook</a> <a href="../tag/monitoring/index.html">monitoring</a> <a href="../tag/privacy/index.html">privacy</a>
				</aside>

				<div class="clear"></div>

						<aside class="post-author">
							<figure class="post-author-avatar avatar">
							</figure>
							<div class="post-author-bio">
								<h4 class="post-author-name"><a href="../author/dieter/index.html">Dieter Vandenbroeck</a></h4>
									<span class="post-author-location"><i class="ic ic-location"></i> Begium</span>
									<span class="post-author-twitter"><i class="ic ic-twitter"></i> <a target="_blank" href="https://twitter.com/@dietervandenbro">Twitter</a></span>
							</div>
							<div class="clear"></div>
						</aside>

			</section>


			<section class="post-comments">
				<a id="show-disqus" class="post-comments-activate">Show Comments</a>
			    <div id="disqus_thread"></div>
			</section>


			<aside class="post-nav">
					<a class="post-nav-next" href="../logs-and-open-eyes-as-protection-against-grinch-bug/index.html">
						<section class="post-nav-teaser">
							<i class="ic ic-arrow-left"></i>
							<h2 class="post-nav-title">Logs and open eyes as protection against the Grinch bug</h2>
							<p class="post-nav-excerpt">The Grinch bug can be exploited to gain administrative privileges on UNIX systems. No official patch is released, and the advise is that 'possession of user logs and knowledge of your own environment' is the best approach.&hellip;</p>
						</section>
					</a>
					<a class="post-nav-prev" href="../apple-pay-might-actually-be-secure/index.html">
						<section class="post-nav-teaser">
							<i class="ic ic-arrow-right"></i>
							<h2 class="post-nav-title">Apple Pay might actually be a truly secure solution for credit card payments</h2>
							<p class="post-nav-excerpt">With Apple Pay, it seems that Apple has introduced a new system that is actually capable of making payments using a credit card, without the risk of losing all credit card numbers in a breach. The solution, based on per-device per-card tokenization, could really help end-user AND merchants.&hellip;</p>
						</section>
					</a>
				<div class="clear"></div>
			</aside>


		</div>
	</article>
</main>


		<div id="body-class" class="post-template tag-anonimity tag-facebook tag-monitoring tag-privacy"></div>

		<footer id="footer">
			<div class="inner">
				<section class="credits">
					<span class="credits-software">Published with <a href="https://ghost.org">Ghost</a> using <a href="https://www.digitalocean.com/">DigitalOcean</a></span>
				</section>
			</div>
		</footer>
	</section>

	<script type="text/javascript" src="../assets/js/script.js%3Fv=7903016016"></script>

	

</body>
</html>
